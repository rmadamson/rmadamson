# CVE-2018-1724: IBM Spectrum LSF Local Privilege Escalation

## Overview

IBM Spectrum LSF is a set of tools designed to provide scheduling and resource management for HPC/Cluster workloads. These tools help make the cluster more efficient by fairly scheduling various user workloads, allowing users to define custom jobs, keeping track of time spent for cost recovery purposes, and orchestrating steps of a compute job across multiple compute nodes. HPC systems are typically used by multiple teams (some of which may be in competition with each other) so both horizontal and vertical privilege escalation vulnerabilities are somewhat more serious than on single-user systems. In addition, user software generally needs to be compiled specifically against local libraries in order to be optimized for HPC computational hardware and high-speed interconnect bridging the compute nodes. Bring-your-own-software is standard practice in scientific computing, so very tight policing of the userspace by the OS kernel is paramount to HPC security. Furthermore, because HPC resources are by definition clustered systems, escalation of privileges of any component often times directly translates to escalation on many components of the distributed HPC system. This vulnerability exposes a flaw in `eauth` -- one tool that LSF uses to authenticate users between multiple parts of the HPC cluster. This writeup will demonstrate how `bsub`, the job submission command, can use `eauth` to submit jobs with the context of another user (including root!).

## Links

https://www.ibm.com/products/hpc-workload-management
https://www.ibm.com/support/pages/node/734767
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1724

## Tools

  * Linux Command Line Tools
  * `strace`
  * LD_PRELOAD
  * Linux System Calls
  * Cryptography
  * Entropy
  * C / gcc
  * HPC Job Submission

## Writeup

`eauth` is a system utility provided by LSF which outputs a secret token to standard out.  The output of the `eauth` command changes regularly when run consistently on the command line. The token is submitted to a job scheduler along with the compute job specification when users run `bsub`.

Example bsub output.

Example eauth output.

### Discovery

The first notable discovery is how simple the output of `eauth` seems to be.  Common web-based api keys are typically much more complex and much longer. Brute-forcing these `eauth` secrets was initially the best plan of attack. However, whenever 

### Investigating Typical Job Submission
##

## Acknowledgements
